<!-- CSS -->
<link rel="stylesheet" type="text/css" href="css/tenants.css" />

<div id="tenants-container"><!-- --></div>

<div id="tenants-error-container"><!-- --></div>
<div id="tenants-warning-container"><!-- --></div>
<div id="tenants-success-container"><!-- --></div>
<div id="tenants-confirmation-container"><!-- --></div>

<div id="tenants-template"><!--
    <h2>__MSG__TENANTS__</h2>
    {var isOnGlobalAdminServer = context.isGlobalAdminServer || context.isTenantOnGlobalAdminServer}
    {if _.keys(tenants).length > 0}
        <table class="table table-striped">
            <tr>
                {if context.isGlobalAdminServer}
                    <th></th>
                {/if}
                <th>__MSG__ALIAS__</th>
                <th>__MSG__NAME__</th>
                {if oae.data.me.isGlobalAdmin}
                    <th colspan="2">__MSG__HOST__</th>
                {else}
                    <th>__MSG__HOST__</th>
                {/if}
                <th>Status</th>
                {if isOnGlobalAdminServer}
                    <th>
                        {if context.isGlobalAdminServer}
                            {if hasStoppedServer}
                                <button type="button" class="btn btn-success start-all-tenants">__MSG__START_ALL__</button>
                            {else}
                                <button type="button" class="btn btn-warning stop-all-tenants">__MSG__STOP_ALL__</button>
                            {/if}
                        {/if}
                    </th>
                    <th></th>
                    <th></th>
                {/if}
            </tr>
            {for tenant in tenants}
                {if tenant.alias}
                    <tr>
                        {if context.isGlobalAdminServer}
                            <td><a href="/tenant/${tenant.alias|encodeForURL}" title="__MSG__EDIT_TENANT__"><i class="icon-pencil"></i></a></td>
                        {/if}
                        <td>${tenant.alias|encodeForHTML}</td>
                        {if oae.data.me.isGlobalAdmin}
                            <td class="jeditable-container"><div class="jeditable-field" data-alias="${tenant.alias|encodeForHTMLAttribute}" data-field="displayName">${tenant.displayName|encodeForHTML}</div></td>
                        {else}
                            <td>${tenant.displayName|encodeForHTML}</td>
                        {/if}
                        {if oae.data.me.isGlobalAdmin}
                            <td class="admin-tenants-visit">
                                <a href="//${tenant.host}" title="__MSG__VISIT_TENANT__" target="_blank"><i class="icon-external-link admin-tenants-visit"></i></a>
                            </td>
                            <td class="jeditable-container">
                               <div class="jeditable-field" data-alias="${tenant.alias|encodeForHTMLAttribute}" data-field="host">${tenant.host|encodeForHTML}</div>
                            </td>
                        {else}
                            <td><a href="//${tenant.host}" title="${tenant.displayName|encodeForHTMLAttribute}" target="_blank">${tenant.host|encodeForHTML}</a></td>
                        {/if}
                        <td>
                            {if tenant.active}
                                <span class="text-success">__MSG__RUNNING__</span>
                            {else}
                                <span class="text-error">__MSG__DISABLED__</span>
                            {/if}
                        </td>
                        {if isOnGlobalAdminServer}
                            <td>
                                {if tenant.active}
                                    <button type="button" class="btn btn-warning stop-tenant" data-alias="${tenant.alias|encodeForHTMLAttribute}" data-displayName="${tenant.displayName|encodeForHTMLAttribute}">__MSG__STOP__</button>
                                {else}
                                    <button type="button" class="btn btn-success start-tenant" data-alias="${tenant.alias|encodeForHTMLAttribute}" data-displayName="${tenant.displayName|encodeForHTMLAttribute}">__MSG__START__</button>
                                {/if}
                            </td>
                            <td>
                                <button type="button" class="btn btn-danger delete-tenant" data-alias="${tenant.alias|encodeForHTMLAttribute}" data-displayName="${tenant.displayName|encodeForHTMLAttribute}">__MSG__DELETE__</button>
                            </td>
                            <td>
                                <button type="button" class="btn btn-primary login-tenant" {if !tenant.active} disabled="disabled" {/if} data-alias="${tenant.alias|encodeForHTMLAttribute}">__MSG__LOGIN__</button>
                            </td>
                        {/if}
                    </tr>
                {/if}
            {/for}
        </table>
    {else}
        <p class="text-warning">__MSG__THERE_ARE_NO_TENANTS__</p>
    {/if}
    {if context.isGlobalAdminServer}
        <div class="admin-container-striped">
            <div>
                <button id="createtenant-toggle-button" type="button" class="btn">
                    <i class="icon-plus pull-left" style="margin-right:12px;"></i>
                    __MSG__CREATE_A_NEW_TENANT__
                </button>
                <div class="createtenant-container clearfix hide">
                    <form method="POST" id="createtenant-form" class="form-horizontal col-sm-7" role="form">
                        <div class="form-group">
                            <label for="createtenant-alias" class="col-sm-3 control-label">__MSG__ALIAS_COLON__</label>
                            <div class="col-sm-9">
                                <input type="text" name="alias" id="createtenant-alias" placeholder="__MSG__ALIAS__" class="form-control required nospaces"/>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="createtenant-displayName" class="col-sm-3 control-label">__MSG__NAME_COLON__</label>
                            <div class="col-sm-9">
                                <input type="text" name="displayName" id="createtenant-displayName" placeholder="__MSG__NAME__" class="form-control required"/>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="createtenant-host" class="col-sm-3 control-label">__MSG__HOST_COLON__</label>
                            <div class="col-sm-9">
                                <input type="text" name="host" id="createtenant-host" placeholder="__MSG__HOST__" class="form-control required url"/>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit" id="createtenant-submit-button" class="btn btn-primary">__MSG__CREATE_NEW_TENANT__</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    {/if}
--></div>

<div id="tenants-confirmation-template"><!--
    <div class="modal" id="${modal.id|encodeForHTMLAttribute}" tabindex="-1" role="dialog" aria-labelledby="${modal.id|encodeForHTMLAttribute}-label" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                    <h3 id="${modal.id|encodeForHTMLAttribute}-label">${modal.title|encodeForHTML}</h3>
                </div>
                <div class="modal-body">
                    <p>${modal.message|encodeForHTML}</p>
                </div>
                <div class="modal-footer">
                    {if modal.cancel}
                        <button class="btn" data-dismiss="modal" aria-hidden="true">${modal.cancel|encodeForHTML}</button>
                    {/if}
                    <button class="btn {if modal.confirmclass} ${modal.confirmclass|encodeForHTMLAttribute}{else} btn-primary{/if}" id="${modal.id|encodeForHTMLAttribute}-confirm"
                        {for attr in modal.confirmdata}
                            data-${attr_index}="${attr|encodeForHTMLAttribute}"
                        {/for}
                        >${modal.confirm|encodeForHTML}
                    </button>
                </div>
            </div>
        </div>
    </div>
--></div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="js/tenants.js"></script>
