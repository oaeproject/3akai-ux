casper.test.begin('Widget - Product video', function(test) {

    /**
     * Verify opening the product video modal with assertions
     */
    var verifyOpenProductModal = function() {
        casper.waitForSelector('.oae-trigger-productvideo', function() {
            test.assertExists('.oae-trigger-productvideo', 'Product video trigger exists');

            // TODO: We need a way to hook into a "page setup" event
            casper.wait(3000, function() {
                casper.click('.oae-trigger-productvideo');
                casper.waitUntilVisible('#productvideo-modal', function() {
                    test.assertExists('#productvideo-modal iframe', 'Product video pane is showing after trigger');
                });
            });
        });
    };

    casper.start(configUtil().tenantUI, function() {
        casper.then(function() {
            casper.echo('Verify product video modal', 'INFO');
            verifyOpenProductModal();
        });
    });

    casper.run(function() {
        test.done();
    });
});
