<!-- CSS -->
<link rel="stylesheet" type="text/css" href="css/contentcomments.css" />

<!-- MAIN VIEW -->
<div class="contentcomments_widget oae-push">
    <div class="contentcomments_item_container">
        <div id="contentcomments_new_comment_container" class="oae-hidden">
            <img class="oae-force-left contentcomments_entity_image" src="/ui/img/entities/user_icon_medium.png">
            <div class="contentcomments_post_comment_body_container">
                <textarea id="contentcomments_post_comment_body" placeholder="__MSG__YOUR_COMMENT__"></textarea>
            </div>
            <button id="contentcomments_post_comment" type="button" class="oae-button oae-overlay-button oae-force-right contentcomments_post_comment">__MSG__COMMENT__</button>
        </div>
        <ul id="contentcomments_content_container"><!-- --></ul>
        <div class="oae-push"><!-- --></div>
    </div>
</div>

<div id="contentcomments_comment_template"><!--
    {for comment in results}
        <li class="contentcomments_comment_container {if comment.level === 1} contentcomments_reply_container {elseif comment.level > 1} contentcomments_reply_container_deep {/if} oae-push" data-id="${comment.commentId}" data-key="${comment.created}">
            {if comment.body === null}
                <img class="oae-force-left contentcomments_entity_image" alt="Deleted comment" src="/ui/img/entities/user_icon_medium.png">
                <div class="contentcomments_comment_box deleted">__MSG__THIS_COMMENT_HAS_BEEN_DELETED__</div>
            {else}
                <img class="oae-force-left contentcomments_entity_image" alt="${comment.createdBy.displayName}" src="{if comment.createdBy.picture.medium}${comment.createdBy.picture.medium}{else}/ui/img/entities/user_icon_medium.png{/if}">
                <div class="contentcomments_comment_box">
                    {if !oae.data.me.anon}
                        <div class="contentcomments_reply_button oae-force-right"></div>
                    {/if}
                    {if canManage || comment.createdBy.id === oae.data.me.id}
                        <div class="contentcomments_delete_button oae-force-right"></div>
                    {/if}
                    {var created = comment.created.split('#').pop()}
                    <div class="oae-bold contentcomments_comment_title">${comment.createdBy.displayName} <span>${$.timeago(new Date(parseInt(created.substring(0, created.length - 1))))}</span></div>
                    ${oae.api.util.security().safeUserInput(comment.body).replace(/\n/g, '<br/>')}
                </div>

                <div class="contentcomments_reply_container oae-hidden">
                    <img class="oae-force-left contentcomments_entity_image" src="{if !oae.data.me.anon && oae.data.me.picture.medium}${oae.data.me.picture.medium}{else}/ui/img/entities/user_icon_medium.png{/if}">
                    <div class="contentcomments_post_comment_body_container">
                        <textarea placeholder="__MSG__YOUR_COMMENT__"></textarea>
                    </div>
                    <button type="button" class="oae-button oae-overlay-button contentcomments_post_reply oae-force-right" data-level="${comment.level + 1}" data-replyTo="${comment.commentId}">__MSG__COMMENT__</button>
                </div>
            {/if}
        </li>
    {/for}
--></div>

<!-- JAVASCRIPT -->
<script type="application/javascript" src="js/contentcomments.js"></script>
