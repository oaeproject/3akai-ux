<!-- CSS -->
<link rel="stylesheet" type="text/css" href="css/topnavigation.css"/>

<div id="topnavigation-container" role="navigation" aria-label="__MSG__TOPNAV_ARIA_LABEL__">
    <!-- ACCESSIBILITY HELPERS -->
    <a id="topnavigation-skip" class="oae-aural-text oae-skip-link hide" href="#topnavigation-target" accesskey="__MSG__SKIP_TOP_MENU_KEY__">__MSG__SKIP_TOP_MENU__</a>
    <a id="lhnavigation-skip"  class="oae-aural-text oae-skip-link hide" href="#lhnavigation-target" accesskey="__MSG__SKIP_TO_LH_MENU_KEY__">__MSG__SKIP_TO_LH_MENU__</a>
    <!-- SCROLL TO TOP -->
    <div id="topnavigation-scroll-to-top_container">
        <button id="topnavigation-scroll-to-top" class="oae-link-button hide" title="__MSG__SCROLL_TO_TOP__" accesskey="s"></button>
    </div>
    <!-- NAVIGATION -->
    <div class="row-fluid">
        <!-- LEFT MENU -->
        <div id="topnavigation-left" class="span4"><!-- --></div>
        <!-- LOGO -->
        <div id="topnavigation-center" class="span4 text-center">
            <a href="/" class="oae-institutional-logo" title="__MSG__OAE__">
                <span class="oae-aural-text">__MSG__OAE__</span>
            </a>
        </div>
        <!-- RIGHT MENU -->
        <div id="topnavigation-right" class="span4 text-right">
            <!-- SEARCH -->
            <form id="topnavigation-search-form" class="navbar-search" role="search" aria-label="__MSG__TOPNAV_SEARCH_ARIA_LABEL__">
                <label for="topnavigation-search-input" class="oae-aural-text">__MSG__SEARCH__</label>
                <input type="text" id="topnavigation-search-input" class="search-query" title="__MSG__SEARCH_FOR__"/>
            </form>
            <div id="topnavigation-search-results-container"><!-- --></div>
        </div>
    </div>
</div>
<h2 id="topnavigation-target" class="oae-aural-text">__MSG__SKIP_MENU_TARGET__</h2>

<!--
//////////////////////////////
// ANONYMOUS NAVIGATION BAR // 
//////////////////////////////
-->

<div id="topnavigation-left-anonymous-template"><!--
    {if oae.api.config.getValue('oae-authentication', 'local', 'allowAccountCreation')}
        <button class="btn btn-link oae-trigger-register">__MSG__SIGN_UP__</button>
    {/if}
--></div>

<div id="topnavigation-right-anonymous-template"><!--
    {var hasLocalAuth = oae.api.config.getValue('oae-authentication', 'local', 'enabled')}
    {var hasExternalAuth = oae.api.config.getValue('oae-authentication', 'facebook', 'enabled') || 
                           oae.api.config.getValue('oae-authentication', 'twitter', 'enabled') || 
                           oae.api.config.getValue('oae-authentication', 'google', 'enabled')}

    <ul class="pull-right inline">
        <li class="dropdown">
            <button id="topnavigation-signin" class="btn btn-link dropdown-toggle" data-toggle="dropdown">__MSG__SIGN_IN__</button>

            <div id="topnavigation-signin-dropdown" class="dropdown-menu pull-right text-left {if hasLocalAuth && hasExternalAuth} topnavigation-signin-dropdown-double {else} topnavigation-signin-dropdown-single {/if}">
                <div class="row-fluid">
                    {if hasExternalAuth}
                        <div class="{if hasLocalAuth && hasExternalAuth} span6 {else} span12 {/if} text-center">
                            <ul id="topnavigation-signin-external" class="inline">
                                {if oae.api.config.getValue("oae-authentication", "facebook", "enabled")}
                                    <li>
                                        <a class="btn-auth btn-facebook" href="/api/auth/facebook">
                                            __MSG__SIGN_IN_WITH_FACEBOOK__
                                        </a>
                                    </li>
                                {/if}
                                {if oae.api.config.getValue("oae-authentication", "twitter", "enabled")}
                                    <li>
                                        <a class="btn-auth btn-twitter" href="/api/auth/twitter">
                                            __MSG__SIGN_IN_WITH_TWITTER__
                                        </a>
                                    </li>
                                {/if}
                                {if oae.api.config.getValue("oae-authentication", "google", "enabled")}
                                    <li>
                                        <a class="btn-auth btn-google" href="/api/auth/google">
                                            __MSG__SIGN_IN_WITH_GOOGLE__
                                        </a>
                                    </li>
                                {/if}
                            </ul>
                        </div>
                    {/if}
                    {if hasLocalAuth}
                        <div class="{if hasLocalAuth && hasExternalAuth} span6 {else} span12 {/if}">
                            <form id="topnavigation-signin-form">
                                <div class="control-group">
                                    <label for="topnavigation-signin-username" class="control-label">__MSG__USERNAME__</label>
                                    <input id="topnavigation-signin-username" name="topnavigation-signin-username" type="text" class="required" maxlength="255">
                                </div>
                                <div class="control-group">
                                    <label for="topnavigation-signin-password" class="control-label">__MSG__PASSWORD__</label>
                                    <input id="topnavigation-signin-password" name="topnavigation-signin-password" type="password" class="required" maxlength="255">
                                </div>
                                <div id="topnavigation-login-actions">
                                    <button id="topnavigation-signin-button" class="btn btn-primary pull-right" type="submit">__MSG__SIGN_IN__</button>
                                    <span id="topnavigation-signin-signing-in" class="hide" class="pull-right">__MSG__SIGNING_IN__...</span>
                                    {if oae.api.config.getValue("oae-authentication", "local", "allowAccountCreation")}
                                        <span>__MSG__NO_ACCOUNT_YET__?
                                            <button id="topnavigation-signin-signup" type="button" class="btn btn-link oae-trigger-register">__MSG__SIGN_UP__</button>
                                        </span>
                                    {/if}
                                </div>
                            </form>
                        </div>
                    {/if}
                </div>
            </div>
        </li>
    </ul>
--></div>

<!--
//////////////////////////////
// LOGGED IN NAVIGATION BAR // 
//////////////////////////////
-->

<div id="topnavigation-left-loggedin-template"><!--
    <ul class="inline topnavigation-menu-buttons" role="menubar">
        <li>
            <a href="/me" class="btn btn-link" title="__MSG__HOME__" role="menuitem">
                <i class="icon-home"><span class="oae-aural-text">__MSG__HOME__</span></i>
            </a>
        </li>
        <li>
            <button class="btn btn-link" title="__MSG__NOTIFICATIONS__" role="menuitem">
                <i class="icon-bullhorn"><span class="oae-aural-text">__MSG__NOTIFICATIONS__</span></i>
                <span id="topnavigation-notification-count" class="badge badge-important">6</span>
            </button>
        </li>
    </ul>
--></div>

<div id="topnavigation-right-loggedin-template"><!--
    <button id="topnavigation-signout" class="btn btn-link" title="__MSG__SIGN_OUT__">
        <i class="icon-signout"><span class="oae-aural-text">__MSG__SIGN_OUT__</span></i>
    </button>
--></div>

<!--
////////////
// SEARCH //
////////////
TODO: Refactor this once we have facetted search
-->

<div id="topnavigation-search-template"><!--
    <div class="oae-popup-white" id="topnav-search-results-suggests">
        <div id="topnav-search-results-top">
            <div class="pull-right">
                <a href="#"><img src="/ui/img/framework/switch-off.png" class="pull-right"/></a>
                <a href="#"><img src="/ui/img/framework/switch-on.png" class="pull-right" style="display: none;"/></a>
                <h3>Search the OAE network</h3>
            </div>
        </div>
        <div>
            <h2>Search</h2>
            <ul role="menu">
                {for r in data.results}
                    <li>
                        <div class="topnav_content_icon_container fl-force-left">
                            {if r.resourceType === 'group' || r.resourceType === 'content'}
                                <span class="oae-visibility-${r.visibility} pull-left"></span>
                            {else}
                                <img src="/ui/img/dummy/live-search-results-preview-person1.png" class="pull-left"/>
                            {/if}
                        </div>
                        <div>
                            <a role="menuitem" tabindex="-1" href="/${r.resourceType}/${r.id}" title="${r.displayName|safeUserInput}" class="oae-bold oae-threedots">${r.displayName|safeUserInput}</a>
                        </div>
                    </li>
                    {if r_index != data.results.length -1}<hr class="oae-split-line"/>{/if}
                {/for}
            </ul>
        </div>
        <div id="topnavigation-search-results-bottom-container">
            {if data.total}
                <a href="/search#l=all&q=${query}" class="oae-button oae-overlay-button pull-right">
                    __MSG__SEE_ALL__
                </a>
            {/if}
            <span id="topnavigation-search_results_bottom_content">
                {if data.total > 0}
                    ${data.total} __MSG__RESULTS__
                {else}
                    __MSG__NO_RESULTS__
                {/if}
            </span>
        </div>
    </div>
--></div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="js/topnavigation.js"></script>
