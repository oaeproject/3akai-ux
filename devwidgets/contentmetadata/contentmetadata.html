<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/contentmetadata/css/contentmetadata.css" />


<div id="contentmetadata_container" class="s3d-highlight_area_background_darker1">
    <div class='s3d-highlight_area_background_darker1_tl'><div class='s3d-highlight_area_background_darker1_tinner'></div></div>
    <h1>__MSG__DETAILS__</h1>
    <div id="contentmetadata_description_container" class="contentmetadata_editable_for_maintainers">
        <!-- -->
    </div>
    <div id="contentmetadata_tags_container" class="contentmetadata_editable_for_maintainers">
        <!-- -->
    </div>
    <div id="contentmetadata_copyright_container" class="collapsible_container contentmetadata_editable_for_maintainers" style="display:none;">
        <!-- -->
    </div>
    <div id="contentmetadata_locations_container" class="collapsible_container contentmetadata_editable_for_maintainers" style="display:none;">
        <!-- -->
    </div>
    <div id="contentmetadata_details_container" class="collapsible_container" style="display:none;">
        <!-- -->
    </div>
    <a href="javascript:;" id="contentmetadata_show_more">
        <div id="contentmetadata_see_more" class="s3d-dropdownlisttwo-text"><span id="contentmetadata_show_more_arrow" class="s3d-dropdownlisttwo-arrow-down"><!-- --></span><span>__MSG__SEE_MORE__</span></div>
        <div id="contentmetadata_see_less" style="display:none;" class="s3d-dropdownlisttwo-text"><span id="contentmetadata_show_less_arrow" class="s3d-dropdownlisttwo-arrow-up"><!-- --></span><span>__MSG__SEE_LESS__</span></div>
    </a>
    <hr class="fl-hidden fl-push">
    <div class='s3d-highlight_area_background_darker1_bl'><div class='s3d-highlight_area_background_darker1_binner'></div></div>
</div>

<div id="contentmetadata_description_template" style="display:none;"><!--
    <div class='s3d-highlight_area_background_darker1_white_content_tl'><div class='s3d-highlight_area_background_darker1_white_content_tinner'></div></div>
    {if data.mode === "edit"}
        <textarea id="contentmetadata_description_description" class="contentmetadata_edit_input">${data.data["sakai:description"]}</textarea>
    {else}
        <span id="contentmetadata_description_display" class="contentmetadata_click">{if $.trim(data.data["sakai:description"]) != ""}${sakai.api.Security.escapeHTML(data.data["sakai:description"])}{else}{if data.isManager}<span class="contentmetadata_manager_edit">__MSG__CLICK_TO_EDIT_DESCRIPTION__</span>{else}__MSG__NO_DESCRIPTION__{/if}{/if}</span>
    {/if}
    <div class='s3d-highlight_area_background_darker1_white_content_bl'><div class='s3d-highlight_area_background_darker1_white_content_binner'></div></div>
--></div>

<div id="contentmetadata_tags_template" style="display:none;"><!--
    <div class='s3d-highlight_area_background_darker1_white_content_tl'><div class='s3d-highlight_area_background_darker1_white_content_tinner'></div></div>
        {if data.mode === "edit"}
            <textarea id="contentmetadata_tags_tags" class="contentmetadata_edit_input">{if typeof data.data["sakai:tags"] != "undefined"}{for tag in data.data["sakai:tags"]}{if tag.split("/")[0] !== "directory"}{if tag_index > 0},{/if}${tag}{/if}{/for}{/if}</textarea>
        {else}
            <span class="contentmetadata_first_column">__MSG__TAGS__:</span>
            {if data.data["sakai:tags"] && $.trim(data.data["sakai:tags"].toString()) != ""}
                <span class="contentmetadata_second_column">
                    {var dirCount = 0;}
                    {for tag in data.data["sakai:tags"]}{if tag.split("/")[0] !== "directory"}{if tag_index - dirCount > 0},{/if} <a href="/search#tag=/tags/${sakai.api.Security.escapeHTML(tag)}" target="_blank" class="s3d-action" title="__MSG__SEARCH_CONTENT_TAGGED_WITH__ '${sakai.api.Security.escapeHTML(tag)}'"">${sakai.api.Security.escapeHTML(tag)}</a>{else}{var dirCount = dirCount + 1;}{/if}{/for}
                </span>
                {if data.data["sakai:tags"].length == dirCount}
                    {if data.isManager}<span class="contentmetadata_manager_edit">__MSG__CLICK_TO_EDIT_TAGS__</span>{else}__MSG__NO_TAGS__{/if}
                {/if}
            {else}
                <span class="contentmetadata_click">
                {if data.isManager}<span class="contentmetadata_manager_edit">__MSG__CLICK_TO_EDIT_TAGS__</span>{else}__MSG__NO_TAGS__{/if}
                </span>
            {/if}
        {/if}
    <div class='s3d-highlight_area_background_darker1_white_content_bl'><div class='s3d-highlight_area_background_darker1_white_content_binner'></div></div>
--></div>

<div id="contentmetadata_copyright_template" style="display:none;"><!--
    <div class='s3d-highlight_area_background_darker1_white_content_tl'><div class='s3d-highlight_area_background_darker1_white_content_tinner'></div></div>
        {if data.mode === "edit"}
            <select id="contentmetadata_copyright_copyright" class="contentmetadata_edit_input">
                {for copyrightLabel in sakai.config.Permissions.Copyright}
                    <option {if data.data["sakai:copyright"] === copyrightLabel_index} selected="selected"{/if} value="${copyrightLabel_index}">${sakai.api.i18n.Widgets.getValueForKey("contentmetadata", "", copyrightLabel.title)}</option>
                {/for}
            </select>
        {else}
            <span class="contentmetadata_first_column">__MSG__COPYRIGHT__: </span>
            {for copyrightLabel in sakai.config.Permissions.Copyright}
                {if data.data["sakai:copyright"] === copyrightLabel_index}
                    <label class="content_profile_basic_info_form_anon_label">
                        ${sakai.api.i18n.Widgets.getValueForKey("contentmetadata", "", copyrightLabel.title)}
                    </label>
                {/if}
            {/for}
        {/if}
    <div class='s3d-highlight_area_background_darker1_white_content_bl'><div class='s3d-highlight_area_background_darker1_white_content_binner'></div></div>
--></div>

<div id="contentmetadata_locations_template" style="display:none;"><!--
    <div class='s3d-highlight_area_background_darker1_white_content_tl'><div class='s3d-highlight_area_background_darker1_white_content_tinner'></div></div>
        <span class="contentmetadata_first_column">__MSG__DIRECTORY_LOCATIONS__:</span>
        {if data.saveddirectory.length != 0}
            <ul>
                {for dir in data.saveddirectory}
                    {var dirString=""}
                    {for dirpiece in dir}
                        ${dirString+=sakai.api.Util.getValueForDirectoryKey(dirpiece)|eat}
                        {if dirpiece_index < dir.length - 1}
                            ${dirString+="&nbsp;&#187;&nbsp;"|eat}
                        {/if}
                    {/for}
                    <li><a href="/search#tag=/tags/directory/${dir.toString().replace(/,/g, '/')}" target="_blank" class="s3d-action threedots_text contentmetadata_locations_link" title="Search content located at ${dirString}"><span class="ellipsis_text contentmetadata_directory_location">
                        {for dirpiece in dir}
                            ${sakai.api.Util.getValueForDirectoryKey(dirpiece)} {if dirpiece_index < dir.length - 1} <span class='contentmetadata_select_seperator'>&raquo;</span>{/if}
                        {/for}
                    </span></a></li>
                {/for}
            </ul>
        {else}
            {if data.isManager}<span class="contentmetadata_manager_edit">__MSG__CLICK_TO_EDIT_LOCATIONS__</span>{else}__MSG__NO_LOCATIONS__{/if}
        {/if}
    <div class='s3d-highlight_area_background_darker1_white_content_bl'><div class='s3d-highlight_area_background_darker1_white_content_binner'></div></div>
--></div>

<div id="contentmetadata_details_template" style="display:none;"><!--
    <div class='s3d-highlight_area_background_darker1_white_content_tl'><div class='s3d-highlight_area_background_darker1_white_content_tinner'></div></div>
        <span class="contentmetadata_content_row">
            <span class="contentmetadata_first_column">__MSG__SIZE__: </span>
            <span>${sakai.api.Util.convertToHumanReadableFileSize(data.data["jcr:content"]["jcr:data"].split(":")[1])}</span>
        </span>
        <span class="contentmetadata_content_row">
            <span class="contentmetadata_first_column">__MSG__TYPE__: </span>
            <span>${data.data["jcr:content"]["jcr:mimeType"]}</span>
        </span>
        <span class="contentmetadata_content_row">
            <span class="contentmetadata_first_column">__MSG__CREATED__: </span>
            <span>${sakai.api.l10n.transformDate(sakai.api.l10n.parseDateString(data.data["jcr:created"], sakai.data.me))}</span>
        </span>
        <span class="contentmetadata_content_row">
            <span class="contentmetadata_first_column">__MSG__LAST_MODIFIED__: </span>
            <span>${sakai.api.l10n.transformDate(sakai.api.l10n.parseDateString(data.data["jcr:content"]["jcr:lastModified"]), sakai.data.me)}</span>
        </span>
        <span class="contentmetadata_content_row">
            <span class="contentmetadata_first_column">__MSG__REVISIONS__: </span>
            <span>{if data.versions.total -1 <= 0}__MSG__NO_REVISIONS__{else}<a href="javascript:;" id="contentmetadata_view_revisions" {if data.data["jcr:content"]["jcr:mimeType"] === "x-sakai/link"}class="link_revision s3d-action"{else}class="s3d-action"{/if}>${data.versions.total -1} __MSG__VERSIONS__</a> __MSG__AVAILABLE__{/if}</span>
        </span>
    <div class='s3d-highlight_area_background_darker1_white_content_bl'><div class='s3d-highlight_area_background_darker1_white_content_binner'></div></div>
--></div>

<!-- DIALOG -->
<div class="dialog" id="contentmetadata_locations_dialog" style="display:none;">
    <!-- HEADER -->
    <div class="dialog_header">
        <div class="dialog_header_inner">
            <h1>__MSG__CONTENT_LOCATION_IN_DIRECTORY__</h1>
            <a href="javascript:;" class="jqmClose dialog_close_image" title="__MSG__CLOSE_DIALOG__">__MSG__CLOSE_DIALOG__</a>
        </div>
    </div>

    <!-- CONTENT -->
    <div class="dialog_content">
        <p>__MSG__WHERE_CAN_THIS_CONTENT_BE_FOUND__</p>
            <div id="contentmetadata_locations_dialog_container" class="s3d-highlight_area_background"><!-- --></div>
            <a href="javascript:;" class="s3d-action" id="contentmetadata_locations_add_another" title="__MSG__ADD_ANOTHER_LOCATION__">__MSG__ADD_ANOTHER_LOCATION__</a>
            <div class="contentmetadata_locations_dialog_actions">
                <button type="button" class="s3d-button jqmClose"><span class="s3d-button-inner">__MSG__DONT_UPDATE__</span></button>
                <button type="button" class="s3d-button s3d-button-primary" id="contentmetadata_locations_dialog_update"><span class="s3d-button-inner">__MSG__UPDATE__</span></button>
            </div>
            <hr class="fl-push fl-hidden"/>
    </div>

    <!-- DIALOG FOOTER -->
    <div class="dialog_footer">
        <div class="dialog_footer_inner"><!-- --></div>
    </div>
</div>

<div id="contentmetadata_locations_dialog_template"><!--
    <div class='s3d-highlight_area_background_tl'>
        <div class='s3d-highlight_area_background_tinner'>
        </div>
    </div>
    <div id="contentmetadata_locations_savedlocations">
        {if data.saveddirectory.length === 0}
            <span id="contentmetadata_no_locations">__MSG__NO_LOCATIONS__</span>
        {else}
            {for dir in data.saveddirectory}
                <li class="contentmetadata_locations_link" id="${dir}">
                    <a href="javascript:;" class="s3d-remove-link s3d-action contentmetadata_remove_location" title="__MSG__REMOVE_LOCATION__">__MSG__REMOVE__</a>
                    <span class="s3d-bold contentmetadata_directory_location contentmetadata_locations_link">${dir.toString().replace(/,/g, " <span class='contentmetadata_select_seperator'>&raquo;</span> ")}</span>
                </li>
            {/for}
        {/if}
    </div>
    <div id="contentmetadata_locations_newlocations_container"></div>
    <hr class="fl-push fl-hidden"/>
    <div class="s3d-highlight_area_background_bl">
        <div class="s3d-highlight_area_background_binner">
        </div>
    </div>
--></div>

    <div id="contentmetadata_location_firstlevel_template"><!--
        <a href="javascript:;" class="s3d-remove-link s3d-action contentmetadata_remove_new_location" title="__MSG__REMOVE_LOCATION__">__MSG__REMOVE__</a>
        <select class="contentmetadata_location_content contentmetadata_location_hierarchy_select contentmetadata_location_directory_lvlone required" name="contentmetadata_location_directory_lvlone">
            <option value="no_value">__MSG__PLEASE_SELECT__</option>
            {for i in directory}
                <option value="${i.name}">${i.name}</option>
            {/for}
        </select>
        <div id="contentmetadata_location_secondlevel_template_container"></div>
        <div id="contentmetadata_location_thirdlevel_template_container"></div>
    --></div>

    <div id="contentmetadata_location_secondlevel_template" style="display:none;"><!--
        <span class="contentmetadata_saved_seperator"> &raquo; </span>
        <select class="contentmetadata_location_content contentmetadata_location_hierarchy_select contentmetadata_location_directory_lvltwo" name="Content directory location">
            <option value="no_value">__MSG__PLEASE_SELECT__</option>
            {for i in directory}
                {if i.name === changedboxvalue}
                    {for j in i.secondlevels}
                        <option value="${j.name}">${j.name}</option>
                    {/for}
                {/if}
            {/for}
        </select>
    --></div>

    <div id="contentmetadata_location_thirdlevel_template" style="display:none;"><!--
        <span class="contentmetadata_saved_seperator"> &raquo; </span>
        <select class="contentmetadata_location_content contentmetadata_location_hierarchy_select contentmetadata_location_directory_lvlthree" name="Content directory location">
            <option value="no_value">__MSG__PLEASE_SELECT__</option>
            {for i in directory}
                {if i.name === firstlevelvalue}
                    {for j in i.secondlevels}
                        {if j.name === changedboxvalue}
                            {for k in j.thirdlevels}
                                <option value="${k.name}">${k.name}</option>
                            {/for}
                        {/if}
                    {/for}
                {/if}
            {/for}
        </select>
    --></div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="/devwidgets/contentmetadata/javascript/contentmetadata.js"></script>