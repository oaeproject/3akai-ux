<link rel="stylesheet" type="text/css" href="/devwidgets/chat/css/chat.css"/>

<div id="chat_available_template" style="display:none"><!--
    <span class="chat_button_image">
        <button type="button" id="chat_available_minimize" class="s3d-link-button s3d-action"></button>
    </span>
    <table>
        <tbody>
            <tr id="chat_available_me" class="chat_top_container">
                <td class="chat_available_image">
                    {if sakai.data.me.profile.picture && $.parseJSON(sakai.data.me.profile.picture).name}
                        <img src="/~${sakai.data.me.user.userid}/public/profile/${$.parseJSON(sakai.data.me.profile.picture).name}" />
                    {else}
                        <img src="/dev/images/user_avatar_icon_48x48.png" />
                    {/if}
                </td>
                <td>
                    <span class="chat_status chat_available_status_${sakaistatus}">&nbsp;</span>
                    <span class="chat_available_name">${sakai.api.Util.shortenString(sakai.api.User.getDisplayName(sakai.data.me.profile), 14)}</span><br />
                    <span id="chat_mystatusmessage" class="chat_available_statusmessage">
                        {if sakai.data.me.profile.status}
                            ${sakai.data.me.profile.status}
                        {else}
                            __MSG__NO_STATUS_MESSAGE__
                        {/if}
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
    <div id="chat_available_others">
        <table>
            <tbody>
                {var index = 0}
                {for i in contacts}
                    {if i.profile.chatstatus != "offline"}
                        ${index++|eat}
                        <tr class="chat_available_friend" id="chat_available_friend_${i.profile.userid}">
                            <td class="chat_available_image">
                                {if i.profile.picture}
                                    <img src="${i.profile.picture}"/>
                                {else}
                                    <img src="/dev/images/user_avatar_icon_32x32.png"/>
                                {/if}
                            </td>
                            <td>
                                <span class="chat_available_status_${i.profile.chatstatus}"></span>
                                <button type="button" class="s3d-link-button s3d-action initiate_chat_window s3d-regular-light-link">${sakai.api.Util.shortenString(i.profile.name, 14)}</button><br />
                                <span id="chat_mystatusmessage" class="chat_available_statusmessage">
                                    {if i.profile.status}
                                        ${sakai.api.Util.shortenString(i.profile.status, 20)}
                                    {else}
                                        __MSG__NO_STATUS_MESSAGE__
                                    {/if}
                                </span>
                            </td>
                        </tr>
                    {/if}
                {/for}
                {if index === 0}
                    <tr>
                        <td id="chat_no_online_connections">
                            __MSG__NO_ONLINE_CONNECTIONS_FOUND__
                        </td>
                    </tr>
                {/if}
            </tbody>
        </table>
    </div>
--></div>

<!-- CHAT WINDOW -->
<div style="display:none" id="chat_windows_template"><!--
    <span class="active_window">
        <span id="chat_online_button_${profile.userid}" class="user_chat">
            <span class="chat_available_status_${profile.chatstatus}"></span>
            <button type="button" id="chat_window_chatstatus_${profile.userid}" class="chat_name_link s3d-link-button s3d-action">${profile.name}</button>
        </span>
    </span>
--></div>

<!-- CHAT WINDOW -->
<div style="display:none" id="chat_windows_windows_template"><!--
        <div id="chat_with_${profile.userid}" class="chat_with_user hidden">

            <table class="chat_top_table">
                <tr class="chat_top_container">
                    <td class="chat_available_image">
                        {if profile.picture}
                            <img src="${profile.picture}" id="chat_window_photo_${profile.userid}" />
                        {else}
                            <img src="/dev/images/user_avatar_icon_48x48.png" id="chat_window_photo_${profile.userid}" />
                        {/if}
                    </td>
                    <td>
                        <span class="chat_user_button_image">
                            <button type="button" class="chat_minimize chat_available_minimize s3d-link-button s3d-action" id="chat_minimize_user1"</button>
                            <button type="button" class="chat_close chat_available_close s3d-link-button s3d-action" id="chat_close_${profile.userid}"></button>
                        </span>
                        <a href="/~${profile.userid}" id="chat_window_name_${profile.userid}" class="chat_window_name">${sakai.api.Util.shortenString(profile.name, 14)}</a><br />
                        <span id="chat_window_statusmessage_${profile.userid}" class="chat_available_statusmessage">
                            {if profile.status}
                                ${sakai.api.Util.shortenString(profile.status, 20)}
                            {else}
                                __MSG__NO_STATUS_MESSAGE__
                            {/if}
                        </span>
                    </td>
                </tr>
            </table>
            <div id="chat_with_${profile.userid}_content" class="chat_with_content_overflow"></div>
            <input id="chat_with_${profile.userid}_txt" class="chat_with_txt" type="text" title="__MSG__PLEASE_INPUT_CHAT_TEXT__" />
        </div>

--></div>

<!-- CHAT MESSAGE -->
<div style="display:none" id="chat_content_template"><!--
    <div class="chat_content_container">
        <span class="chat_content_name">${name}</span><span class="chat_content_time">${time}</span><br />
        <span class="chat_content_message">${message}</span>
    </div>
--></div>

<!-- CHAT CONTAINER -->
<div class="chat_main_container" id="chat_main_container" style="display:none;">
    <div id="chat_container">
        <table class="chat_main_table" summary="Chat">
            <tr>
                <td id="chat_windows"></td>
                <td id="chat_online_connections_link">
                    <div id="chat_online_button">
                        <div id="chat_online_list_activator">
                            <div id="chat_people_icon"></div>
                            <span class="chat_straight_link" id="chat_online"></span>
                        </div>

                        <!-- SHOW ONLINE FRIENDS -->
                        <div id="chat_show_online" style="display:none">
                            <div id="chat_available"></div>
                        </div>

                    </div>
                </td>
            </tr>
        </table>
        <div id="chat_windows_container"><!-- --></div>
    </div>
</div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="/devwidgets/chat/javascript/chat.js"></script>
