<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/allcategories/css/allcategories.css" />

<div style="display:none">__MSG__IE_PLACEHOLDER__</div>

<div class="allcategories_widget">
    <div id="allcategories_items_container"><!----></div>
</div>

<div id="allcategories_items_template"><!--
    <div id="allcategories_items_content">
        <ul>
            {var size = 125}
            {for item in directory}
                {if item.divider}
                    </ul>
                     {if item.title} 
                         <h1 class="fl-push s3d-contentpage-title {if item.cssClass} ${item.cssClass} {/if}">${item.title}</h1> 
                     {else} 
                         <div class="s3d-contentpage-title fl-push {if item.cssClass} ${item.cssClass} {/if}"></div> 
                    {/if} 
                    <ul {if item.cssClass} class="${item.cssClass}" {/if}>
                {else}
                    <li>
                        <div class="allcategories_item">
                            <a href="/category#l=${item.id}">
                                <div class="allcategories_item_header">
                                    <div class="allcategories_item_raquo"></div>
                                    <h2 class="allcategories_item_header_link s3d-regular-links s3d-bold">${item.title}</h2>
                                    <span class="allcategories_item_header_meta">${item.count || 0} {if item.count === 1} __MSG__CONTENT_ITEM__{else} __MSG__CONTENT_ITEMS__{/if}</span>
                                </div>
                            </a>
                            {if item.content}
                                {if item.content["sakai:pooled-content-file-name"]}
                                    {var canShare = sakai.api.Content.canCurrentUserShareContent(item.content)}
                                    <div class="s3d-draggable-container" data-canshare="${canShare}" data-scope="content" data-entityid="${item.content["_path"]}" {if sakai.api.Content.Collections.isCollection(item.content)} data-collection="true" {/if}>
                                        {var thumbnail = sakai.api.Content.getThumbnail(item.content)}
                                        {if thumbnail}
                                            <img src="${thumbnail}" class="allcategories_item_content_preview" alt="${item.content["sakai:pooled-content-file-name"]|safeOutput}"/>
                                        {else}
                                            <img src="${sakai.api.Content.getMimeTypeData(item.content["_mimeType"]).URL}" class="allcategories_item_content_preview" alt="${item.content["sakai:pooled-content-file-name"]|safeOutput}"/>
                                        {/if}
                                        <a href="/content#p=${item.content["_path"]}/${item.content["sakai:pooled-content-file-name"]|safeURL}" class="s3d-regular-links s3d-bold" title="${item.content["sakai:pooled-content-file-name"]|safeURL}">${sakai.api.Util.applyThreeDots(item.content["sakai:pooled-content-file-name"], size, null, "s3d-bold")}</a>
                                        <span style="display:none"><span class="allcategories_item_descriptive_text">__MSG__BY__</span> <a href="/~${item.content["sakai:pool-content-created-for"]}" class="s3d-regular-links s3d-bold">${item.content["sakai:pool-content-created-for"]}</a></span>
                                        {if item.content["sakai:description"]}
                                            <span class="allcategories_content_description">${sakai.api.Util.applyThreeDots(item.content["sakai:description"], size)}</span>
                                        {/if}
                                        <span class="allcategories_content_category_description"><span class="allcategories_content_usedin_icon allcategories_content_icon"></span>__MSG__USED_IN__ ${item.content.usedin} {if item.content.usedin == 1} __MSG__PLACE__{else} __MSG__PLACES__{/if}</span>
                                        {if item.content.commentcount}<span class="allcategories_content_category_description"><span class="allcategories_content_comments_icon allcategories_content_icon"></span><a href="/content#p=${item.content["_path"]|safeURL}/${item.content["sakai:pooled-content-file-name"]|safeURL}" class="s3d-bold s3d-regular-links"><span class="s3d-aural-text">${item.content["sakai:pooled-content-file-name"]|safeURL} __MSG__HAS__ </span>${item.content.commentcount} {if item.content.commentcount == 1} __MSG__COMMENT__{else} __MSG__COMMENTS__{/if}</a></span>{/if}
                                        {if item.content["sakai:tags"] && sakai.api.Util.formatTags(item.content["sakai:tags"]).length > 0}
                                            {var realTags = sakai.api.Util.formatTags(item.content["sakai:tags"])}
                                            <span class="allcategories_content_tags">
                                                {for tag in realTags}
                                                    {if tag_index < 2}
                                                        <a href="${tag.link}" class="s3d-action" title="${tag.linkTitle}">${tag.value}</a>{if tag_index < realTags.length-1 && tag_index < 1}, {/if}
                                                    {/if}
                                                {/for}
                                            </span>
                                        {/if}
                                    </div>
                                {/if}
                            {/if}
                            <hr class="fl-push fl-hidden"/>
                        </div>
                    </li>
                {/if}
            {/for}
        </ul>
    </div>
--></div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="/devwidgets/allcategories/javascript/allcategories.js"></script>
