<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/categories/css/categories.css" />

<div class="categories_widget">
    <div id="categories_items_container" class="jcarousel-skin-tango"><!----></div>
    <div id="categories_expand_contract">
        <div class="categories_contract" style="display:none;"><!----></div>
        <div class="categories_expand"><!----></div>
        <span class="s3d-bold">__MSG__CHOOSE_A_CATEGORY__</span>
    </div>
</div>

<div id="categories_items_template"><!--
    <div id="categories_items_scroll">
        <a href="/dev/allcategories.html" title="__MSG__VIEW_ALL__" class="categories_view_all_link">
            <button type="button" class="s3d-button s3d-button-link-2-state" id="categories_view_all">
                <span class="s3d-button-inner s3d-button-link-2-state-inner">__MSG__VIEW_ALL__</span>
            </button>
        </a>
        <div id="categories_items_scroll_buttons">
            {var count = 1}
            {for item in directory}
                {if item_index % 4 == 0}
                    {if count == 1}
                        <div class="categories_items_scroll_scrollbutton categories_items_scroll_selected" id="scroll_${count}"></div>
                    {else}
                        <div class="categories_items_scroll_deselected categories_items_scroll_scrollbutton" id="scroll_${count}"></div>
                    {/if}
                {/if}
                {var count = count + 1}
            {/for}
        </div>
    </div>
    <div id="categories_items_content">
        <ul>
            {for item in directory}
                <li>
                    <div class="categories_item">
                        <a href="/search#tag=/tags/${item.title}" class="s3d-regular-links categories_item_header_link">${item.title}</a>
                        <span class="categories_item_header_meta">${total} content items</span>
                        <hr class="s3d-split-line fl-push">
                        {if item.featuredcontent.image}
                            <img src="/p/${item.featuredcontent["jcr:name"]}" class="categories_item_content_preview" alt="${item.featuredcontent["sakai:pooled-content-file-name"]}"/>
                        {elseif item.featuredcontent["sakai:custom-mimetype"]}
                            ${debug.log(item)};
                            <img src="${sakai.api.Content.getMimeTypeData(item.featuredcontent["sakai:custom-mimetype"]).URL}" class="categories_item_content_preview"/>
                        {elseif item.featuredcontent.haspreview}
                            <img src="/p/${item.featuredcontent["jcr:name"]}.page1-small.png" class="categories_item_content_preview" alt="${item.featuredcontent["sakai:pooled-content-file-name"]}"/>
                        {else}
                            <img src="${sakai.api.Content.getMimeTypeData(item.featuredcontent["_mimeType"]).URL}" class="categories_item_content_preview"/>
                        {/if}
                        <a href="/content#content_path=/p/${item.featuredcontent["jcr:path"]}" class="s3d-regular-links">${item.featuredcontent["sakai:pooled-content-file-name"]}</a>
                        <span class="categories_item_header_meta_small">Used by 19 people</span>
                        <hr class="fl-push fl-hidden"/>
                        <span class="categories_item_tags">
                            {for tag in item.featuredcontent["sakai:tags"]}
                                {if tag_index < 3}
                                    <a href="/search#tag=/tags/${tag}" class="s3d-regular-links">${tag}</a>{if tag_index < item.featuredcontent["sakai:tags"].length-1 && tag_index < 2}<span class="s3d-bold categories_tag_divider">&#183;</span>{/if}
                                {/if}
                            {/for}
                        </span>
                    </div>
                    {if item_index != directory.length - 1}
                        <div class="categories_vertical_divider"></div>
                    {/if}
                </li>
            {/for}
        </ul>
    </div>
--></div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="/devwidgets/categories/javascript/categories.js"></script>