<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/entity/css/entity.css" />

<div id="entity_container"><span style="display:none;">__MSG__IE_PLACEHOLDER__</span></div>

<div id="entity_contentsettings_dropdown" style="display:none"><!--
    <div id="entity_dropdown_wrapper" class="s3d-dropdown-list">
        <div class="s3d-dropdown-list-arrow-up"></div>
        <ul>
            <li id="ew_permissions">
                <button class="s3d-link-button">__MSG__PERMISSIONS__</button>
            </li>
            <hr class="s3d-split-line"/>
            {if data && data.data && data.data.mimeType && data.data.mimeType !== "x-sakai/document" && sakai_global.content_profile.content_data.data["_mimeType"] !== "x-sakai/link"}
                <li id="ew_upload">
                    <button class="s3d-link-button">__MSG__UPLOAD_NEW_VERSION__</button>
                </li>
                <hr class="s3d-split-line"/>
            {/if}
            {if sakai_global.content_profile.content_data.data["_mimeType"] !== "x-sakai/document" && sakai_global.content_profile.content_data.data["_mimeType"] !== "x-sakai/link"}
                <li id="ew_revhistory">
                    <button class="s3d-link-button">__MSG__REVISION_HISTORY__</button>
                </li>
                <hr class="s3d-split-line"/>
            {/if}
            <li id="ew_content_preview_delete">
                <button class="s3d-link-button">__MSG__DELETE__</button>
            </li>
        <ul>
    </div>
--></div>

<div id="entity_groupsettings_dropdown" style="display:none"><!--
    <div id="entity_dropdown_wrapper" class="s3d-dropdown-list">
        <div class="s3d-dropdown-list-arrow-up"></div>
        <ul>
            <li id="ew_group_add_content">
                <button class="s3d-link-button sakai_add_content_overlay">__MSG__ADD_CONTENT__</button>
            </li>
            <hr class="s3d-split-line"/>
            <li id="ew_group_participants">
                <button class="s3d-link-button addpeople_init">__MSG__MANAGE_PARTICIPANTS__</button>
            </li>
            <hr class="s3d-split-line"/>
            {if joinable}
            <li id="ew_group_join_requests">
                <button class="s3d-link-button" id="ew_group_join_requests_link">__MSG__JOIN_REQUESTS__</button>
            </li>
            <hr class="s3d-split-line"/>
            {/if}
            <li id="ew_group_settings">
                <button class="s3d-link-button" id="ew_group_settings_edit_link">__MSG__SETTINGS__</button>
            </li>
            {if sakai.config.enableCategories}
                <hr class="s3d-split-line"/>
                <li id="ew_group_categories">
                    <button class="s3d-link-button" id="ew_group_categories_link">__MSG__CATEGORIES__</button>
                </li>
            {/if}
        <ul>
    </div>
--></div>

<div id="entity_user_template" style="display:none"><!--
    <div id="entity_actions">
        {if !anon}
            {if type != "user_anon" && type != "user_me"}
                {if type == "user_other"}
                    <button type="button" id="entity_user_add_to_contacts" class="s3d-button s3d-header-button sakai_addtocontacts_overlay" sakai-entityid="${data.userid}" sakai-entityname="${data.displayName}" {if data.picture}sakai-entitypicture="${data.picture}"{/if}>__MSG__ADD_TO_CONTACTS__<span class="entity_add_to_contacts_icon entity_user_action_icon"></span></button>
                {elseif type == "contact_invited"}
                    <button type="button" id="entity_user_accept_invitation" class="s3d-button s3d-header-button">__MSG__ACCEPT_INVITATION__<span class="entity_add_to_contacts_icon entity_user_action_icon"></span></button>
                {elseif type == "contact_pending"}
                    <button type="button" class="s3d-button s3d-header-button entity_user_contact_pending" disabled="disabled">__MSG__CONTACT_INVITATION_SENT__<span class="entity_add_to_contacts_requested_icon entity_user_action_icon"></span></button>
                {/if}
                <button type="button" id="entity_user_message" class="s3d-button s3d-header-button sakai_sendmessage_overlay" sakai-entityid="${data.userid}" sakai-entityname="${data.displayName}" sakai-entitytype="user">__MSG__MESSAGE__<span class="entity_message_icon entity_user_action_icon"></span></button>
            {/if}
        {/if}
    </div>
    {if type && type == "user_me"}
        <div id="entity_user_image" class="entity_change_avatar">
            <div class="entity_profilepic_internal">
                <img id="entity_profile_picture" alt="__MSG__PROFILE_PICTURE_FOR__ ${data.displayName}" src="{if data.picture}${data.picture}{else}/dev/images/default_User_icon_50x50.png{/if}"/>
            </div>
            <div class="s3d-dropdown-menu-arrow entity_profile_picture_down_arrow"></div>
            <div class="s3d-dropdown-list" style="display:none;">
                <div class="s3d-dropdown-list-arrow-up"></div>
                <ul>
                    <li><a id="changepic_container_trigger" href="javascript:;" class="s3d-bold">__MSG__CHANGE_PICTURE__</a></li>
                </ul>
            </div>
        </div>
        <div class="s3d-bold entity_name_me">${data.displayName}</div>
    {else}
        <div id="entity_user_image" class="entity_other_profilepic">
            <div class="entity_profilepic_internal">
                <img id="entity_profile_picture" alt="__MSG__PROFILE_PICTURE_FOR__ ${data.displayName}" src="{if data.picture}${data.picture}{else}/dev/images/default_User_icon_50x50.png{/if}"/>
            </div>
        </div>
        <div id="entity_name" class="s3d-bold">${data.displayName}</div>
        <div id="entity_owns" class="s3d-regular-links">
            <span class="entity_number">
                {var contentCount = data.profile.counts["contentCount"] || 0}
                ${contentCount}
                {if contentCount === 1}
                    __MSG__DOCUMENT_LC__
                {else}
                    __MSG__DOCUMENTS_LC__
                {/if}
                </span>,
            <span class="entity_number">
                {var membershipsCount = data.profile.counts["membershipsCount"] || 0}
                ${membershipsCount}
                {if membershipsCount === 1}
                    __MSG__MEMBERSHIP_LC__
                {else}
                    __MSG__MEMBERSHIPS_LC__
                {/if}
                </span>,
            <span class="entity_number">
                {var contactsCount = data.profile.counts["contactsCount"] || 0}
                ${contactsCount}
                {if contactsCount === 1} 
                    __MSG__CONTACT_LC__
                {else}
                    __MSG__CONTACTS_LC__
                {/if}
                </span>
        </div>
    {/if}
--></div>

<div id="entity_newaccount_template" style="display:none"><!--
    <div class="s3d-bold entity_plaintitle">Create new account</div>
--></div>

<div id="entity_s23site_template" style="display:none"><!--
    <div class="s3d-bold entity_plaintitle">
        ${data.title}
        <span id="s23_site_title_info">__MSG__SAKAI_2_SITE__</span>
    </div>
--></div>

<div id="entity_acknowledgements_template" style="display:none"><!--
    <div class="s3d-bold entity_plaintitle">Acknowledgements</div>
--></div>

<div id="entity_search_template" style="display:none"><!--
    <div class="s3d-bold entity_plaintitle">Search</div>
--></div>

<div id="entity_directory_template" style="display:none"><!--
    <div id="entity_directory_image" class="entity_directory_image">
        {if data.icon}
            <img src="${data.icon}" alt="${data.title}"/>
        {else}
            <img src="/dev/images/hierarchy.png"  alt="${data.title}"/>
        {/if}
    </div>
    <div id="entity_name" class="s3d-bold entity_plaintitle">${data.title|safeOutput}</div>
--></div>

<div id="entity_content_template" style="display:none"><!--
    <div id="entity_actions">
        {if !anon}
            {if type && type == "content_managed"}
                <button type="button" id="entity_content_permissions" class="s3d-button s3d-button-no-text s3d-header-button"><span class="entity_permissions_icon">__MSG__DOWN_ARROW__</span></button>
            {/if}
            <button type="button" id="entity_content_save" class="s3d-button s3d-header-button savecontent_trigger" data-entityid="${data.data["_path"]}">__MSG__ADD_TO_LIBRARY__<span class="entity_add_to_library"></span></button>
        {/if}
        <button type="button" id="entity_content_share" class="s3d-button s3d-header-button share_trigger_click" data-entityid="${data.data["_path"]}">__MSG__SHARE__<span class="entity_share_content"></span></button>
        {if data.data.mimeType === "x-sakai/link"}
            <a id="contentpreview_download_button" href="${data.data["sakai:pooled-content-url"]}" class="s3d-button s3d-header-button fl-force-right s3d-margin-top-5" target="_blank">
                __MSG__OPEN_LINK__<span class="entity_download_content"></span>
            </a>
        {elseif data.data.mimeType !== "x-sakai/document"}
            <a id="contentpreview_download_button" href="${data.path}" class="s3d-button s3d-header-button fl-force-right s3d-margin-top-5" target="_blank">
                __MSG__DOWNLOAD__<span class="entity_download_content"></span>
            </a>
        {/if}
    </div>
    <div id="entity_content_image" class="entity_content_image">
        {if data.isManager}
            <div id="entity_managed_content"></div>
        {/if}
        <img src="${data.data['iconURL']}" alt="${data.data["sakai:pooled-content-file-name"]|safeOutput}"/>
    </div>
    <span id="entity_name" {if data.isManager}class="s3d-bold contentmetadata_editable"{/if}>${data.data["sakai:pooled-content-file-name"]|safeOutput}</span>
    <span id="entity_name_edit" style="display:none">
        <input id="entity_name_text" type="text" />
    </span>
    <div id="entity_owns" class="s3d-regular-links">
        {var peopleCount = data.members.counts.people}
        <div class="entity_number">
            <div id="entity_used_by_icon" class="entity_content_details_icon"></div>
            __MSG__USED_BY__
            <a href="#" title="${peopleCount} {if peopleCount == 1} __MSG__PERSON_LC__{else} __MSG__PEOPLE_LC__{/if}" class="entity_content_people">
                ${peopleCount}
                {if peopleCount == 1}__MSG__PERSON_LC__{else}__MSG__PEOPLE_LC__{/if}
            </a>
        </div>
        {var groupCount = data.members.counts.groups}
        {if groupCount}
            and
            <a href="#" class="entity_content_group">
                ${groupCount}
                {if groupCount == 1} __MSG__GROUP_LC__{else} __MSG__GROUPS_LC__{/if}
            </a>
        {/if}
        <span class="entity_comments">
            <img src="/devwidgets/entity/images/entity_comment_icon.png" alt="__MSG__COMMENTS__" />
            {var commentCount = sakai.api.Content.getCommentCount(data.data)}
            <a id="entity_comments_link" href="#">${commentCount} {if commentCount == 1} __MSG__COMMENT__{else} __MSG__COMMENTS__{/if}</a>
        </span>
        <div class="entity_number entity_permissions_label">
            {var permissions = data.data["sakai:permissions"]}
            <div id="entity_${permissions}_privacy_icon" class="entity_content_details_icon"></div>
            {if permissions == "public"}
                __MSG__VISIBLE_TO_ANYONE__
            {elseif permissions == "everyone"}
                __MSG__VISIBLE_TO_LOGGED__
            {else}
                __MSG__PRIVATE_TO__ ${sakai.api.User.getDisplayName(sakai.data.me.profile)}
                {if (peopleCount + groupCount) > 1}
                    + ${groupCount + peopleCount - 1} __MSG__OTHERS__
                {/if}
            {/if}
        </div>
    </div>
--></div>

<div id="entity_group_template" style="display:none"><!--
    <div id="entity_actions">
        {if !anon}
            {if type && type == "group_managed"}
                <button type="button" id="entity_group_permissions" class="s3d-button s3d-header-button s3d-button-no-text"><span class="entity_permissions_icon">__MSG__DOWN_ARROW__</span></button>
            {else}
                <div id='widget_joinrequestbuttons' class='widget_inline'></div>
            {/if}
            <button sakai-entitytype="group" sakai-entityname="${data.authprofile["sakai:group-title"]|safeOutput}" sakai-entityid="${data.authprofile["sakai:group-id"]}" type="button" class="s3d-button s3d-header-button sakai_sendmessage_overlay">__MSG__MESSAGE__<span class="entity_message_icon entity_user_action_icon"></span></button>
        {/if}
    </div>
    {if type && type == "group_managed"}
        <div id="entity_group_image" class="entity_change_avatar">
            <div class="entity_profilepic_internal">
                <img id="entity_profile_picture" alt="__MSG__GROUP_PICTURE_FOR__ ${data.authprofile["sakai:group-title"]}" src="{if data.authprofile.picture}${data.authprofile.picture}{else}/devwidgets/entity/images/entity_default_group.png{/if}"/>
            </div>
            <div class="s3d-dropdown-menu-arrow entity_profile_picture_down_arrow"></div>
            <div class="s3d-dropdown-list" style="display:none;">
                <div class="s3d-dropdown-list-arrow-up"></div>
                <ul>
                    <li><a id="changepic_container_trigger" href="javascript:;" class="s3d-bold">__MSG__CHANGE_PICTURE__</a></li>
                </ul>
            </div>
        </div>
    {else}
        <div id="entity_group_image" class="entity_other_profilepic">
            <div class="entity_profilepic_internal">
                <img id="entity_profile_picture" alt="__MSG__GROUP_PICTURE_FOR__ ${data.authprofile["sakai:group-title"]|safeOutput}" src="{if data.authprofile.picture}${data.authprofile.picture}{else}/devwidgets/entity/images/entity_default_group.png{/if}"/>
            </div>
        </div>
    {/if}
    <div id="entity_name" class="s3d-bold">${data.authprofile["sakai:group-title"]|safeOutput}</div>
    <div id="entity_owns" class="s3d-regular-links">
        <span class="entity_number">
            {var contentCount = data.authprofile["contentCount"] || 0}
            ${contentCount}
            {if contentCount === 1}
                __MSG__DOCUMENT_LC__
            {else}
                __MSG__DOCUMENTS_LC__
            {/if}
            </span>,
            <span class="entity_number">
            {var membersCount = data.authprofile["membersCount"] || 0}
            <span id="entity_participants_count">
                ${membersCount}
            </span>
            <span id="entity_participants_text">
                {if membersCount === 1}
                    __MSG__PARTICIPANT__
                {else}
                    __MSG__PARTICIPANTS__
                {/if}
            </span>
        </span>
    </div>
    {if type && type == "group_managed"}
        <div class="entity_user_picture_dropdown entity_user_dropdown" style="display:none;">
            <div class="entity_dropdown_content s3d-dropdown-menu">
                <ul>
                    <li><a href="#" class="s3d-bold">__MSG__CHANGE_PICTURE__</a></li>
                </ul>
            </div>
        </div>
    {/if}
--></div>

<!-- <div id="entity_group_image" class="entity_group_image {if type && type == "group_managed"} entity_user_image_pointer{/if} "></div> -->

<!-- DIALOG BOX FOR CONTENT PROFILE USERS -->
<div id="entity_content_users_dialog" class="s3d-dialog s3d-dialog-container" style="width:500px; margin-left: -250px">
    <div class="s3d-dialog-close jqmClose"></div>
    <h1 id="entity_content_users_dialog_heading" class="s3d-dialog-header"><!-- --></h1>
    <div>
        <!-- CONTAINER -->
        <div id="entity_content_users_dialog_list_container"><!-- --></div>

        <!-- TEMPLATE -->
        <div id="entity_content_users_dialog_list_template" style="display:none;"><!--
            <ul class="entity_content_users_dialog_list">
                {var userlist_groups_index = 0}
                {var userlist_people_index = 0}
                {for i in userList}
                    {if i['sakai:group-id'] && type === "groups"}
                        ${userlist_groups_index++|eat}
                        {if userlist_groups_index%2} <li id="${i['sakai:group-id']}">
                        {else} <li id="${i['sakai:group-id']|safeOutput}" class="entity_content_even">
                        {/if}
                        {if i.pseudoGroup}
                            <a href="/~${i.parent['sakai:group-id']|safeOutput}" target="_blank"><img src="/dev/images/group_avatar_icon_35x35_nob.png" alt="${i.parent['sakai:group-title']}" class="s3d-icon-32 entity_content_picture"/></a>
                            <span class="entity_content_name">
                                <a class="s3d-regular-links s3d-bold" href="/~${i.parent['sakai:group-id']|safeURL}" target="_blank">${i.parent['sakai:group-title']|safeOutput} <span class="entity_pseudogroup">${i.parent["sakai:role-title"]|safeOutput}</span></a>
                            </span>
                        {else}
                            {if i.pictureUrl}
                                <a href="/~${i['sakai:group-id']|safeURL}" target="_blank"><img src="${i.pictureUrl}" alt="${i['sakai:group-title']}" class="entity_content_picture"/></a>
                            {else}
                                <a href="/~${i['sakai:group-id']|safeURL}" target="_blank"><img src="/dev/images/group_avatar_icon_35x35_nob.png" alt="${i['sakai:group-title']}" class="s3d-icon-32 entity_content_picture"/></a>
                            {/if}
                            <span class="entity_content_name">
                                <a class="s3d-regular-links s3d-bold" href="/~${i['sakai:group-id']|safeURL}" target="_blank">${i['sakai:group-title']|safeOutput}</a>
                            </span>
                         {/if}
                        </li>
                    {elseif i["rep:userId"] && type === "people"}
                        ${userlist_people_index++|eat}
                        {var displayName = sakai.api.User.getDisplayName(i)}
                        {if !displayName}
                            {var displayName = i.displayName}
                        {/if}
                        {if userlist_people_index%2} <li id="${i["rep:userId"]}">
                        {else} <li id="${i["rep:userId"]|safeOutput}" class="entity_content_even">
                        {/if}
                        {if i.pictureUrl}
                            <a href="/~${i["rep:userId"]|safeURL}" target="_blank"><img src="${i.pictureUrl}" alt="${displayName}" class="entity_content_picture"/></a>
                        {else}
                            <a href="/~${i["rep:userId"]|safeURL}" target="_blank"><img src="/dev/images/default_User_icon_35x35.png" alt="${displayName}" class="s3d-icon-32 entity_content_picture"/></a>
                        {/if}
                        <span class="entity_content_name">
                            <a class="s3d-regular-links s3d-bold" href="/~${i["rep:userId"]|safeURL}" target="_blank">${displayName}</a>
                        </span>
                        </li>
                    {/if}
                {/for}
            </ul>
            --></div>

        <div class="dialog_buttons fl-force-right">
            <button type="button" class="s3d-button s3d-overlay-action-button jqmClose">__MSG__CLOSE__</button>
        </div>
        <hr class="fl-push fl-hidden">
    </div>
</div>

<!-- i18n MESSAGES -->
<div id="entity_notifications" style="display:none">
    <span id="entity_content_groups">__MSG__THE_FOLLOWING_GROUPS_USING_CONTENT__</span>
    <span id="entity_content_people">__MSG__THE_FOLLOWING_PEOPLE_USING_CONTENT__</span>
</div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="/devwidgets/entity/javascript/entity.js"></script>
